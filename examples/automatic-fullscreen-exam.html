<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automatic Fullscreen Exam Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }

        .exam-start {
            background: rgba(255, 255, 255, 0.1);
            padding: 40px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            margin: 50px 0;
        }

        .security-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            z-index: 9999;
            display: none;
        }

        .security-badge.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button:hover {
            background: #1976D2;
            transform: translateY(-2px);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .exam-content {
            display: none;
            padding: 20px;
        }

        .exam-content.active {
            display: block;
        }

        .question {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            text-align: left;
        }

        .alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #f44336;
            color: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 10000;
            display: none;
        }

        .alert.show {
            display: block;
            animation: alertFade 0.5s ease-out;
        }

        @keyframes alertFade {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
    </style>
</head>
<body>
    <div class="security-badge" id="securityBadge">
        üîí Secure Mode Active
    </div>

    <div class="alert" id="alertBox">
        <h3 id="alertTitle">Security Alert</h3>
        <p id="alertMessage">This is a security alert message.</p>
        <button onclick="closeAlert()">OK</button>
    </div>

    <div class="container">
        <div class="exam-start" id="examStart">
            <h1>üîí Secure Exam Environment</h1>
            <div style="text-align: left; max-width: 500px; margin: 0 auto;">
                <h3>‚ö†Ô∏è Security Features:</h3>
                <ul>
                    <li>‚úÖ Automatic fullscreen mode (no manual steps)</li>
                    <li>‚úÖ All activities monitored in real-time</li>
                    <li>‚úÖ Tab switching and copy/paste disabled</li>
                    <li>‚úÖ Right-click and developer tools blocked</li>
                    <li>‚úÖ Automatic re-entry if fullscreen exited</li>
                </ul>
            </div>
            
            <button onclick="startSecureExam()" id="startBtn">
                üöÄ Start Secure Exam (Auto Fullscreen)
            </button>
        </div>

        <div class="exam-content" id="examContent">
            <h2>üìù Sample Exam Questions</h2>
            
            <div class="question">
                <h3>Question 1: JavaScript Fundamentals</h3>
                <p>What is the difference between <code>let</code> and <code>var</code> in JavaScript?</p>
                <textarea style="width: 100%; height: 100px; margin: 10px 0;"></textarea>
            </div>

            <div class="question">
                <h3>Question 2: Security Concepts</h3>
                <p>Explain the importance of secure exam environments in online testing.</p>
                <textarea style="width: 100%; height: 100px; margin: 10px 0;"></textarea>
            </div>

            <div class="question">
                <h3>Question 3: Browser APIs</h3>
                <p>How does the Fullscreen API work in modern browsers?</p>
                <textarea style="width: 100%; height: 100px; margin: 10px 0;"></textarea>
            </div>

            <button onclick="submitExam()" style="margin: 20px 0;">
                Submit Exam
            </button>
        </div>
    </div>

    <script>
        class AutoFullscreenExam {
            constructor() {
                this.isSecureMode = false;
                this.examInProgress = false;
                this.setupEventListeners();
            }

            setupEventListeners() {
                // Fullscreen change detection
                document.addEventListener('fullscreenchange', () => this.handleFullscreenChange());
                document.addEventListener('webkitfullscreenchange', () => this.handleFullscreenChange());
                document.addEventListener('mozfullscreenchange', () => this.handleFullscreenChange());
                document.addEventListener('MSFullscreenChange', () => this.handleFullscreenChange());

                // Security event prevention
                document.addEventListener('contextmenu', (e) => this.preventAction(e, 'Right-click disabled'));
                document.addEventListener('copy', (e) => this.preventAction(e, 'Copying disabled'));
                document.addEventListener('paste', (e) => this.preventAction(e, 'Pasting disabled'));
                document.addEventListener('keydown', (e) => this.handleKeydown(e));

                // Tab visibility monitoring
                document.addEventListener('visibilitychange', () => {
                    if (document.hidden && this.examInProgress) {
                        this.showAlert('Security Warning', 'Tab switching detected! This action has been logged.');
                    }
                });

                // Prevent page navigation during exam
                window.addEventListener('beforeunload', (e) => {
                    if (this.examInProgress) {
                        e.preventDefault();
                        e.returnValue = 'Leaving the exam will be recorded as suspicious activity. Are you sure?';
                        return e.returnValue;
                    }
                });
            }

            async enterFullscreen() {
                try {
                    const element = document.documentElement;
                    
                    if (element.requestFullscreen) {
                        await element.requestFullscreen();
                    } else if (element.webkitRequestFullscreen) {
                        await element.webkitRequestFullscreen();
                    } else if (element.mozRequestFullScreen) {
                        await element.mozRequestFullScreen();
                    } else if (element.msRequestFullscreen) {
                        await element.msRequestFullscreen();
                    }
                    
                    console.log('‚úÖ Entered fullscreen mode automatically');
                    return true;
                } catch (error) {
                    console.error('‚ùå Failed to enter fullscreen:', error);
                    this.showAlert('Error', 'Unable to enter fullscreen mode. Please press F11 to continue.');
                    return false;
                }
            }

            async exitFullscreen() {
                try {
                    if (document.exitFullscreen) {
                        await document.exitFullscreen();
                    } else if (document.webkitExitFullscreen) {
                        await document.webkitExitFullscreen();
                    } else if (document.mozCancelFullScreen) {
                        await document.mozCancelFullScreen();
                    } else if (document.msExitFullscreen) {
                        await document.msExitFullscreen();
                    }
                    
                    console.log('‚úÖ Exited fullscreen mode');
                } catch (error) {
                    console.error('‚ùå Failed to exit fullscreen:', error);
                }
            }

            handleFullscreenChange() {
                const isFullscreen = !!(document.fullscreenElement || 
                                       document.webkitFullscreenElement || 
                                       document.mozFullScreenElement ||
                                       document.msFullscreenElement);
                
                this.isSecureMode = isFullscreen;
                const badge = document.getElementById('securityBadge');
                
                if (isFullscreen) {
                    badge.classList.add('active');
                } else {
                    badge.classList.remove('active');
                    
                    // If exam is in progress and user exits fullscreen, attempt to re-enter
                    if (this.examInProgress) {
                        this.showAlert('Security Warning', 'Exiting fullscreen during exam is not allowed. Re-entering automatically...');
                        setTimeout(() => {
                            this.enterFullscreen();
                        }, 2000);
                    }
                }
            }

            handleKeydown(event) {
                if (!this.examInProgress) return;

                const isCtrl = event.ctrlKey || event.metaKey;
                const key = event.key.toLowerCase();

                // Prohibited key combinations
                const prohibitedKeys = {
                    'f12': true,     // Developer Tools
                    'f11': true,     // Fullscreen toggle (handled automatically)
                    'c': isCtrl,     // Ctrl+C
                    'v': isCtrl,     // Ctrl+V
                    'x': isCtrl,     // Ctrl+X
                    'p': isCtrl,     // Ctrl+P
                    's': isCtrl,     // Ctrl+S
                    'u': isCtrl,     // Ctrl+U
                    'i': isCtrl && event.shiftKey, // Ctrl+Shift+I
                    'j': isCtrl && event.shiftKey, // Ctrl+Shift+J
                };

                if (prohibitedKeys[key]) {
                    this.preventAction(event, `Key combination ${isCtrl ? 'Ctrl+' : ''}${event.key} is disabled`);
                }

                // Alt+Tab detection
                if (event.altKey && event.key === 'Tab') {
                    this.preventAction(event, 'Alt+Tab is disabled during exam');
                }
            }

            preventAction(event, message) {
                event.preventDefault();
                console.log('üö´ Security Prevention:', message);
                this.showAlert('Action Blocked', message);
                return false;
            }

            showAlert(title, message) {
                const alertBox = document.getElementById('alertBox');
                const alertTitle = document.getElementById('alertTitle');
                const alertMessage = document.getElementById('alertMessage');

                alertTitle.textContent = title;
                alertMessage.textContent = message;
                alertBox.classList.add('show');

                // Auto-dismiss after 5 seconds
                setTimeout(() => {
                    this.closeAlert();
                }, 5000);
            }

            closeAlert() {
                const alertBox = document.getElementById('alertBox');
                alertBox.classList.remove('show');
            }

            async startExam() {
                console.log('üöÄ Starting secure exam with automatic fullscreen...');
                
                const startBtn = document.getElementById('startBtn');
                startBtn.disabled = true;
                startBtn.textContent = 'Entering Secure Mode...';

                // Simulate connection to monitoring server
                await new Promise(resolve => setTimeout(resolve, 1000));

                // Enter fullscreen automatically
                const success = await this.enterFullscreen();
                
                if (success) {
                    this.examInProgress = true;
                    
                    // Hide start screen and show exam content
                    document.getElementById('examStart').style.display = 'none';
                    document.getElementById('examContent').classList.add('active');
                    
                    console.log('‚úÖ Secure exam environment activated');
                } else {
                    // Fallback if fullscreen fails
                    startBtn.disabled = false;
                    startBtn.textContent = 'Try Again';
                    this.showAlert('Setup Failed', 'Could not enter secure mode. Please try again or contact support.');
                }
            }

            async endExam() {
                console.log('üìù Ending secure exam...');
                
                this.examInProgress = false;
                
                // Exit fullscreen
                await this.exitFullscreen();
                
                // Show completion message
                this.showAlert('Exam Complete', 'Your exam has been submitted successfully. You may now close this window.');
                
                console.log('‚úÖ Exam completed and secure mode disabled');
            }
        }

        // Initialize the automatic fullscreen exam system
        const autoFullscreenExam = new AutoFullscreenExam();

        // Global functions for UI interaction
        function startSecureExam() {
            autoFullscreenExam.startExam();
        }

        function submitExam() {
            if (confirm('Are you sure you want to submit your exam? This action cannot be undone.')) {
                autoFullscreenExam.endExam();
            }
        }

        function closeAlert() {
            autoFullscreenExam.closeAlert();
        }

        // Demonstration logging
        console.log('üîí Automatic Fullscreen Exam Demo Loaded');
        console.log('üëÜ Click "Start Secure Exam" to see automatic fullscreen in action');
        console.log('üö´ Try right-clicking, Ctrl+C, F12, etc. to test security features');
    </script>
</body>
</html>
